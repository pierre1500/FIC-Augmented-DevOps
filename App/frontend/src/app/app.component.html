<div class="container">
  <h1>{{ title }}</h1>

  <button (click)="refreshData()" style="float: right; margin-bottom: 20px;">
    ðŸ”„ Refresh
  </button>
  <div class="clear"></div>

  <div class="lists">
    <div class="stock">
      <h2>Stock</h2>
      <ul>
        <li *ngFor="let item of (stock | async)?.productList">
          {{ item.product.productName }} - ${{ item.product.productPrice.toFixed(2) }} ({{ item.quantity }} available)
        </li>
      </ul>
    </div>

    <div class="cart">
      <h2>Cart</h2>
      <ul>
        <li *ngFor="let product of cart">
          {{ product.name }} - ${{ product.price.toFixed(2) }} x {{ product.quantity }}
          <button (click)="removeFromCart(product)">-</button>
          <button (click)="addToCart(product)">+</button>
        </li>
      </ul>
      <p><strong>Total:</strong> ${{ getCartTotal().toFixed(2) }}</p>
      <button (click)="validateOrder()">Validate Order</button>
    </div>
  </div>

  <div>
    <h2>Products</h2>
    <ul>
      <li *ngFor="let product of products | async">
        {{ product.productName }} - ${{ product.productPrice.toFixed(2) }}
        <button (click)="addToCart(product)">Add to Cart</button>
      </li>
    </ul>
  </div>

  <div>
    <h2>Orders</h2>
    <ul *ngIf="(orders | async)?.length ?? 0 > 0; else noOrders">
      <li *ngFor="let order of orders | async">
        Order ID: {{ order.id }}
        <ul>
          <li *ngFor="let item of order.orderedProductDtoList">
            {{ item.product.productName }} - Quantity: {{ item.quantity }}
          </li>
        </ul>
      </li>
    </ul>
    <ng-template #noOrders>
      <p>No orders available.</p>
    </ng-template>
  </div>

  <div>
    <h2>Importer des produits</h2>
    <input type="file" (change)="onFileSelected($event)" accept=".txt,.csv" />
    <button (click)="uploadProducts()">Upload</button>
    <span *ngIf="uploadProgress !== null">ProgressionÂ : {{ uploadProgress }}%</span>
    <span *ngIf="uploadMessage">{{ uploadMessage }}</span>
  </div>
</div>
